# Fuzzing 101

>[!faq] What is fuzzing?
>**Fuzzing** or fuzz testing is an automated software testing technique that involves providing invalid, unexpected, or random data as inputs to a computer program. The program is then monitored for exceptions such as crashes, failing built-in code assertions, or potential memory leaks.

One-line Perl fuzzer:

```perl
$ perl -e 'print "\x41" x20 . "BCD" x3;'
```

One-line Python fuzzer + little-endian inversion:

```bash
$ export ExploitEducation=$(python -c 'import struct; print "A"*64 + struct.pack("I", 0x0d0a090a)')
```

Dedicated script (python2):

```python
#!/usr/bin/python
import socket

# Create an array of buffers, while incrementing them

buffer=["A"]
counter=100
while len(buffer) <= 30:
    buffer.append("A"*counter)
    counter=counter+200

for string in buffer:
    print "Fuzzing PASS with %s bytes" % len(string)
    s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    connect=s.connect(('192.168.1.1',110))
    s.recv(1024)
    s.send('USER test\r\n')
    s.recv(1024)
    s.send('PASS ' + string + '\r\n')
    s.send('QUIT\r\n')
    s.close()
```

Alternative (python3):

```python
#!/usr/bin/env python3

import socket, time, sys

ip = "10.10.208.211"

port = 1337
timeout = 5
prefix = "OVERFLOW1 "

string = prefix + "A" * 100

while True:
  try:
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
      s.settimeout(timeout)
      s.connect((ip, port))
      s.recv(1024)
      print("Fuzzing with {} bytes".format(len(string) - len(prefix)))
      s.send(bytes(string, "latin-1"))
      s.recv(1024)
  except:
    print("Fuzzing crashed at {} bytes".format(len(string) - len(prefix)))
    sys.exit(0)
  string += 100 * "A"
  time.sleep(1)
```

Spike:

```bash
┌──(kali㉿kali)-[~/CTFs/THM/Buffer-Overflow-Prep/vulnserver]
└─$ cat trun.spk             
s_readline();
s_string("TRUN ");
s_string_variable("0");

┌──(kali㉿kali)-[~/CTFs/THM/Buffer-Overflow-Prep/vulnserver]
└─$ generic_send_tcp 10.10.108.230 9999 trun.spk 0 0
Total Number of Strings is 681
Fuzzing
Fuzzing Variable 0:0
line read=Welcome to Vulnerable Server! Enter HELP for help.
Fuzzing Variable 0:1
line read=Welcome to Vulnerable Server! Enter HELP for help.
Variablesize= 5004
Fuzzing Variable 0:2
line read=Welcome to Vulnerable Server! Enter HELP for help.
Variablesize= 5005
Fuzzing Variable 0:3
line read=Welcome to Vulnerable Server! Enter HELP for help.
Variablesize= 21
Fuzzing Variable 0:4
line read=Welcome to Vulnerable Server! Enter HELP for help.
```

# Web fuzzing tools

- [ffuf](../Tools/ffuf.md)
- wfuzz
- [Burpsuite](../Tools/Burpsuite.md) (Intruder)
- [REcollapse](https://github.com/0xacb/recollapse) (a helper tool for black-box regex fuzzing to bypass validations and discover normalizations in web applications)
- [regrets](https://github.com/AvalZ/regrets) (Use Z3 to generate strings that match or do not match multiple regex)

# Other resources

- [Leveling Up Fuzzing: Finding more vulnerabilities with AI](../../Readwise/Articles/Erik%20-%20Last%20Week%20in%20Security%20(LWiS)%20-%202024-11-25.md#^124d62)