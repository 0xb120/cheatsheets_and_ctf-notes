{"path":"Dev, ICT & Cybersec/Web & Network Hacking/attachments/sync-token-pattern-1.png","text":"Synchronizer Token Pattern (Flask-login + Flask-WTF) ﬁ Flask SRR https://bank.com o GET /login Client-side sessions, cryptographically signed csrf_token=to Set-Cookie: session={csrf:[, id:None} s = <random value> 0 POST /login ° t = <exp_time, Cookie: session={csrf:s@, id:None} HMAC(SECRET, exp_time, s)> - user/password & csrf_token=t@ Hi Bob £ tok N Verification: - MiBob, csrftoken=ti | exp_time, h = t Set-Cookie: session={csrf:[E, id:bob} if h == HMAC(SECRET, exp_time, s): o POST /action return True _— ° Cookie: session={csrf:s@, id:bob} return False - csrf_token=t1","libVersion":"0.5.0","langs":"eng"}