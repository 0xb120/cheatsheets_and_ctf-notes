---
author: "Sonny"
aliases: "Get FortiRekt, I Am the Super_Admin Now - FortiOS Authentication Bypass CVE-2024-55591"
tags: RW_inbox, readwise/articles
url: 
date: 2025-02-27
---
# Get FortiRekt, I Am the Super_Admin Now - FortiOS Authentication Bypass CVE-2024-55591

![rw-book-cover](https://labs.watchtowr.com/content/images/2025/01/fortirekt-1.png)

## Highlights


critical zero-day vulnerability affecting FortiOS products.
[View Highlight](https://read.readwise.io/read/01jn44xxj9khhpzsh6detgsv91)



As always though, because secrecy is what this industry thrives on, details emerged from Arctic Wolf’s [article](https://arcticwolf.com/resources/blog/console-chaos-targets-fortinet-fortigate-firewalls/?ref=labs.watchtowr.com) *before Fortinet had a chance to throw together an advisory where they find someone to blame for product security issues*, which explains parts of the campaign, including pre to post-exploitation activities and IoCs.
[View Highlight](https://read.readwise.io/read/01jn44y7vdx90sv4fdt60xvy8n)



Regardless, what we could glean was that the vulnerability resided within the `jsconsole` functionality, which is a GUI feature to execute CLI commands inside FortiOS’s management interface.
[View Highlight](https://read.readwise.io/read/01jn44ycabvssjd1dwqt2ptjfg)



Fortinet managed to publish their [advisory](https://www.fortiguard.com/psirt/FG-IR-24-535?ref=labs.watchtowr.com) for CVE-2024-55591, containing a little more information:
 > An Authentication Bypass Using an Alternate Path or Channel vulnerability [CWE-288] affecting FortiOS and FortiProxy may allow a remote attacker to gain super-admin privileges via crafted requests to Node.js websocket module.
[View Highlight](https://read.readwise.io/read/01jn44yvdx27xnpn6hhknejh3a)



The file system
 As you may recall from previous FortiGate adventures, a decrypted FortiGate’s `rootfs.gz` looks pretty much like this:
 bin.tar.xz
 boot
 data
 data2
 dev
 etc
 fortidev
 init
 lib
 migadmin.tar.xz
 node-scripts.tar.xz
 proc
 rootfs
 sbin
 sys
 tmp
 usr
 usr.tar.xz
 var
[View Highlight](https://read.readwise.io/read/01jn44z4nez8c1dc8473dbsj7g)



we used the `/sbin/xz` binary to extract a small collection of node-related files:
 /ssl-vpn
 /ssl-vpn/provision-user
 /ssl-vpn/provision-user/qr_codes
 /index.js
 /f85a0baf050df19d250a479301fcbc0f.node
 /logs
 /report-runner
 /report-runner/lang
 /report-runner/sfas
 /9f7fd545476a9e07af2abe8a61bcdb01.node
[View Highlight](https://read.readwise.io/read/01jn450ay84wc1gcvbb1vc529a)



We’re quick to realize at this point that the core code for the Node.js component resides with `index.js`, which comes in at a whopping ***53,642*** lines of JavaScript code
[View Highlight](https://read.readwise.io/read/01jn450pyv79xrgbfxsjkapb3e)



PoC and Conclusion
[View Highlight](https://read.readwise.io/read/01jn453w0fgff3v8ntfa7yw8z5)



This vulnerability isn’t "just" a simple Authentication Bypass but a chain of issues combined into one critical vulnerability. To summarise this vulnerability in a digestible format, four important things are happening:
 1. A WebSocket connection can be created from a pre-authenticated HTTP request.
 2. A special parameter `local_access_token` can be used to skip session checks.
 3. A race condition in the WebSocket → Telnet CLI allows us to send authentication before the server does.
 4. The authentication which is raced by us contains no unique key, password or identifier to establish a user. We can just pick an choose our access profile (super_admin it is!).
[View Highlight](https://read.readwise.io/read/01jn4544sm07266swjhfyejwtf)



We recently [released a detection script](https://github.com/watchtowrlabs/fortios-auth-bypass-check-CVE-2024-55591/tree/main?ref=labs.watchtowr.com) to identify vulnerable instances, as our "we promise we're nice people" gesture.
[View Highlight](https://read.readwise.io/read/01jn454y1k0mpr16xk2z0d0q3t)

