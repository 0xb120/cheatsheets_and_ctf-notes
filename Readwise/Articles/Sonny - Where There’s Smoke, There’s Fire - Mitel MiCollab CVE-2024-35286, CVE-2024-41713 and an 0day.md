---
author: "Sonny"
aliases: "Where There’s Smoke, There’s Fire - Mitel MiCollab CVE-2024-35286, CVE-2024-41713 and an 0day"
tags: RW_inbox, readwise/articles
url: https://labs.watchtowr.com/where-theres-smoke-theres-fire-mitel-micollab-cve-2024-35286-cve-2024-41713-and-an-0day/
date: 2024-12-19
---
# Where There’s Smoke, There’s Fire - Mitel MiCollab CVE-2024-35286, CVE-2024-41713 and an 0day

![rw-book-cover](https://labs.watchtowr.com/content/images/2024/12/mitel.png)


When looking at an #Apache config, there are several key directives that dictate paths of interest. For example, we’re keen to look at the following: [](https://read.readwise.io/read/01jff94jvbj64dv07rs43pe9zv)
 • `Location`
 • `ProxyPass`
 • `RewriteRule`
 • `ProxyPassReverse`
 • `Alias`


Well, when looking at Apache or Java applications, no ‘smoke investigation kit’ is complete without [Orange Tsai’s trusty research](https://i.blackhat.com/us-18/Wed-August-8/us-18-Orange-Tsai-Breaking-Parser-Logic-Take-Your-Path-Normalization-Off-And-Pop-0days-Out-2.pdf?ref=labs.watchtowr.com) centering around the input `..;/` , which can result in path normalization and the ability to traverse sub-contexts. [](https://read.readwise.io/read/01jff98qryv8jekqfcp58rj295)

To briefly explain Orange Tsai’s amazing research in the context of a Java application residing on Apache/Tomcat, it was discovered that the special syntax `..;/` can be used to truncate paths/traverse out of contexts.
> [](https://read.readwise.io/read/01jff99r7s41c69sjapxtdmnxb)



So how do you test for it? If we look at the below Apache configuration line:
 ProxyPassReverse /npm-pwg/ <http://127.0.0.1:8080/npm-pwg/>
 We can see that any value supplied after the path `/npm-pwg/` is proxied to a different application server, residing on `http://localhost:8080` (similarly to our example above). We can perform a quick ‘litmus test’ with two URLs, `/npm-pwg/..;/` and `/watchTowr/..;/`, and we see that we get two different 404 pages back for the two URLs, indicating that two different contexts are being reached.
> [](https://read.readwise.io/read/01jff9fjmvcb7tx2pp8nw3tkj0)



If we look for other routes that reside on the `8080` application server, we can see an interesting path of `/npm-admin/` :
 ProxyPassReverse /npm-admin/ <http://127.0.0.1:8080/npm-admin/>
 When trying to request this route at the root path, like a normal user would, we’re met with a boring status of `401 Unauthorized`. However, in conjunction with our traversal, we can reach its content:
 GET /npm-pwg/..;/npm-admin/ HTTP/1.1
 Host: {{Hostname}}
 ![](https://labs.watchtowr.com/content/images/2024/11/image-42.png)
 O
> [](https://read.readwise.io/read/01jff9kcf523skgrqsnr0m79xr)



