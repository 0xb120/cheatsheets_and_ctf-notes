---
author: William Moody
aliases:
  - "CVE-2025-25599: A Cautionary Tale of Insecure Temporary Files"
tags:
  - readwise/articles
url: https://certitude.consulting/blog/en/bolt-cms/?__readwiseLocation=
date: 2025-03-21
summary: A security issue was found in the Bolt content management system where temporary files used for avatar uploads could be accessed publicly, allowing attackers to download sensitive files like `/etc/passwd`. The problem arises because the temporary folder is publicly accessible, and avatar URLs are not properly validated. Patches have been released to fix this vulnerability.
---
# CVE-2025-25599: A Cautionary Tale of Insecure Temporary Files

![rw-book-cover](https://readwise-assets.s3.amazonaws.com/static/images/article0.00998d930354.png)

During a security assessment of #Bolt - https://boltcms.io/, an open-source content management system, it was discovered that temporary files are used *insecurely* when uploading an avatar from a URL, leading to arbitrary file disclosure ([CVE-2025-25599](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-25599)) [](https://read.readwise.io/read/01jpwkzqt4z1e8bm6tc0n9tqhe)
The backend performs these steps in the following order:
 1. A temporary folder is created
 2. The file pointed to by the URL is downloaded into the temporary folder
 3. The function `handleUpload` is executed
 4. The temporary file is deleted [](https://read.readwise.io/read/01jpwm07hejpwmpcstp0qm5p21)

Before setting a new avatar, various validation checks are carried out against the file size, extension, and contents. If all checks pass, only then is the user’s avatar updated. [](https://read.readwise.io/read/01jpwm0rh9my3g04fdaxv1s5gm)

What is the issue? It turns out that the temporary folder is `[BOLT_PATH]/public/files/tmp`, which, as the name suggests, is *publicly accessible* (e.g. [http://example.com/files/tmp/](http://localhost:8001/files/tmp/)). This means that for the few milliseconds they exist, *temporary files may be downloaded*. 

Furthermore, avatar URLs are not properly validated, and it is possible to “upload” local files using the `file://` protocol, e.g. [file:///etc/passwd](https:///etc/passwd). [](https://read.readwise.io/read/01jpwm1a7zzyf0n5wc59tvbng0)

Either by reviewing the source code, or by monitoring the temporary folder, we can determine the naming convention for temporary files. In the case of `/etc/passwd`, a temporary file called `avatarspasswd` is created. [](https://read.readwise.io/read/01jpwm1j8hccykn2bjv3jr37aj)
```sh
 root@host:/opt/bolt/public/files/tmp# while [ 1==1 ]; do ls; done 
 avatarspasswd 
 avatarspasswd 
 avatarspasswd 
 avatarspasswd 
 avatarspasswd 
```
 

If an attacker were able to time the request correctly, they could download the file from [http://example.com/files/tmp/avatarspasswd](http://localhost:8001/files/tmp/avatarspasswd). [](https://read.readwise.io/read/01jpwm1s65nwe32sfwhvbrvv9q)
