---
author: Summoning Team
aliases:
  - "Breaking Down Barriers: Exploiting Pre-Auth SQL Injection in WhatsUp Gold CVE-2024-6670"
tags:
  - readwise/articles
url: https://summoning.team/blog/progress-whatsup-gold-sqli-cve-2024-6670/
date: 2024-09-07
---
# Breaking Down Barriers: Exploiting Pre-Auth SQL Injection in WhatsUp Gold CVE-2024-6670

![rw-book-cover](https://summoning.team/../assets/images/featured/cover-CVE-2024-6670_hu8c66b2c3f75d78ef03d38aa367de2465_130573_1200x630_resize_box_3.png)

## Highlights


> I discovered an unauthenticated SQL injection against the latest version of progress whatsup gold and turned it into a authentication bypass
> [View Highlight](https://read.readwise.io/read/01j76v0y5vksy22t4t00a44p2q)



> I have recently made my [Advanced .NET Exploitation Training](https://summoning.team/) public,
> [View Highlight](https://read.readwise.io/read/01j76v2hrb5kt4n0jsxr03gxv9)



> the vulnerability is obvious, the `classid` is being used to construct a SQL query without sanitization, leading to a vanilla SQL injection
> [View Highlight](https://read.readwise.io/read/01j76v3z2s12bd5409cfsr73ak)



> Exploitation for Authentication Bypass
>  Usually one would use a SQL injection to retrieve/reset a high-privilege user password, other techniques might involve storing a payload in a certain column and trigger some functionality of the application to cause further impact because mostly data is sanitized when received from the user, and not when retrieved from the database, this could be triggering deserialization, code eval, command injection, etc
> [View Highlight](https://read.readwise.io/read/01j76v4myr0q2cb0120k870md0)



> I decided to see if its possible to either retrieve or override the administrator-user password field
> [View Highlight](https://read.readwise.io/read/01j76v5qacd8gp6rgq2k8nezj1)



> The password seems to be encrypted, I started looking for how the application retrieve’s and use the password
> [View Highlight](https://read.readwise.io/read/01j76v6d8ddbsakvnd39eb36zx)



> So lets quicly find who is behind the CLSID, I use OleView .NET from James forshaw to look for this CLSID
> [View Highlight](https://read.readwise.io/read/01j76v7qqrc2skvek350xk3ppw)
> #tools 


> I was able to decrypt the password easily, however analyzing the decryption process further, shows that although some hard-coded values have been used for the crypto APIs, there are some values that are unique to each installation and this made the decryption inconsistent, meaning the call to this DecryptString method on one machine can decrypt a password that was generated on the same machine and not another installation instance.
> [View Highlight](https://read.readwise.io/read/01j76v98xx5qde1gtjfvnj94rd)



> I decided to look more into the application, I had an idea that what “IF” there is a way I can encrypt something using the application in an unauthenticated manner?
> [View Highlight](https://read.readwise.io/read/01j76va7c04p56s6bjez353s7s)



> the encrypted data is stored in the `GlobalSettings` table, specifically the `_GLOBAL_:JavaTrustStorePwd` or `_GLOBAL_:JavaKeyStorePwd` entries, this table has the settings of the application, we can use this endpoint to encrypt any known value and have it stored in that table
> [View Highlight](https://read.readwise.io/read/01j76vbnpxbtaa4tnxtdx3hktd)



> This is perfect, having the application to encrypt any data we want and store it in a different table so we can later reuse this encrypted value via our SQL injection primitive to update another column inside another table that is the administrator password
> [View Highlight](https://read.readwise.io/read/01j76vcag4qm5eysbqam27rbqw)



> So here is how the final attack flow works in a nutshell
>  ![](https://summoning.team/images/blog/whatsupgold-haserrors/flow.png)
> [View Highlight](https://read.readwise.io/read/01j76vcthtffegxzpkp7xbr610)

