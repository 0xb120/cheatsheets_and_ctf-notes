---
raindrop_id: 1333613728
raindrop_highlights:
  68d6aa7015d4063d7770de3c: ee2c2165089dc9330cb3239d5d3d1d0e
  68d6aa8aa2be5671f23bbfd8: 16d014acecd7bcc969c486b613f6afdf
  68d6aa9d08ae98bc809c1af8: 7b75637ad138c0f5c60f4ab648966767
  68d6aabdb81b9bf2809eb178: 2632907652ef34ac180dab2a67f94daf
  68d6ab0b5430135b7f9e4195: eed9807738fe6419c0708dce882b614f
  68d6ab1e5430135b7f9e4459: 672e8a6ba01540af7a755d2eaa459258
title: "You Already Have Our Personal Data, Take Our Phone Calls Too (FreePBX CVE-2025-57819)"

description: |-
  null

source: https://labs.watchtowr.com/you-already-have-our-personal-data-take-our-phone-calls-too-freepbx-cve-2025-57819/

created: 1757541719562
type: article
tags:
  - "_index"

 
  - "Inoreader" 
  - "tech-blog"

---
# You Already Have Our Personal Data, Take Our Phone Calls Too (FreePBX CVE-2025-57819)

![](https://labs.watchtowr.com/content/images/size/w1200/2025/09/Group-8730--21-.png)

> [!summary]
> null





The vulnerability sits right at the start of doRequest, in a deceptively simple check.

if (class_exists(ucfirst($module)) && $module != "directory")


This is… not great. The condition just drops the attacker-controlled module parameter straight into class_exists. But why does that matter?

At first glance, it seems harmless - just a class name lookup. But when we actually checked the PHP documentation, we realized something important: class_exists doesn’t just take a single argument. It accepts a second argument: autoload.

If autoload is true, PHP will happily try to automatically load whatever class name you feed it. Since the default is true, our attacker-controlled input into class_exists means PHP will go looking for a class file on disk.
But here’s the twist: we don’t actually care about loading a class. What we really want is for PHP to execute a static script like admin/modules/endpoint/ajax.php. That’s where FreePBX’s custom magic enters the scene.
Inside functions.inc.php - a helper file loaded early in execution - FreePBX registers its own autoloader:

spl_autoload_register('fpbx_framework_autoloader');
According to the official documentation, this function lets you register your own custom handlers for class autoloading. In practice, that means when class_exists is called, the attacker-supplied module parameter is handed straight over to the fpbx_framework_autoloader function.
This is it! The custom FreePBX class loader allows you to include any file ending with the .php extension from the admin/modules location!
Put simply: attackers can hit certain module files directly without needing to authenticate.